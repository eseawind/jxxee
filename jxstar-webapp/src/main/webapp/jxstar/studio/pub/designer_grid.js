Jxstar.currentPage={nodeId:"",target:"",createDesign:function(nodeId,target){if(nodeId==null||nodeId.length==0){JxHint.alert(jx.star.noid);return}this.nodeId=nodeId;this.target=target;var self=this;var hdCall=function(f){var node=(eval(f))();node.config.eventcfg=self.createEventCfg(nodeId);node.setState("1");var page=node.showPage();if(page==null){return}page.id=nodeId+"_des_grid";var subpage=target.getComponent(0);if(subpage!=null){target.remove(subpage,true)}var store=page.getStore();var record=new (store.reader.recordType)({});store.add(record);target.add(page);target.doLayout()};var params="funid=sys_fun_base&eventcode=query_griddes&projectpath="+Jxstar.session.project_path;params+="&selfunid="+nodeId;Request.dataRequest(params,hdCall,{type:"xml",wait:true})},createEventCfg:function(d){var c=this;var a=function(){var f=function(){var h="funid=sys_fun_base&eventcode=deletegd";h+="&selfunid="+d+"&selpagetype=grid";var g=function(){c.createDesign(c.nodeId,c.target)};Request.postRequest(h,g)};Ext.Msg.confirm(jx.base.hint,jx.fun.delyes,function(g){if(g=="yes"){f()}})};var b=function(){var g="funid=sys_fun_base&eventcode=savegd";g+="&selfunid="+d+"&selpagetype=grid";var f=this.grid.getState();var n=this.grid.colModel;var j=f.columns;var l="";if(j){for(var h=0,k=j.length;h<k;h++){var o=j[h];var m=n.getColumnById(o.id);if(m){if(m.dataIndex.length==0){continue}l+="{";l+="n:"+m.dataIndex+",";l+="w:"+o.width+",";l+="h:"+(o.hidden?"true":"false");l+="}-"}}if(j.length>0){l=l.substring(0,l.length-1)}}g+="&content="+l;Request.postRequest(g,null)};var e=function(){var f="funid=sys_fun_base&eventcode=creategd";f+="&selfunid="+d+"&selpagetype=grid&projectpath="+Jxstar.session.project_path;Request.postRequest(f,null)};return{deletegd:a,savegd:b,creategd:e}}};